<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-W04-4 05:11 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Econf World Wide Web</title>
<meta name="author" content="Inanna" />
<meta name="description" content="Search engine configuration for emacs." />
<meta name="generator" content="Org Mode" />
<link href="site.css" rel="stylesheet" type="text/css" /><link href="images/website-icon.png" rel="icon" />
</head>
<body>
<div id="preamble" class="status">
<div><a href="index.html"><img alt="A red logo the left half of which is a gear containing a control diagram and the right half is a rose." id="site-logo" src="/images/website-logo.png" /></a></div>
</div>
<div id="content" class="content">
<h1 class="title">Econf World Wide Web</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org033b4fa">Introduction</a></li>
<li><a href="#org18eb131">Dependencies</a></li>
<li><a href="#org34b4e95">Variables</a>
<ul>
<li><a href="#orga060223">Setting Browsers (and stuff)</a></li>
<li><a href="#orgb026291">The w3m Directory</a></li>
<li><a href="#orgde77ec1">Further Customizations</a></li>
</ul>
</li>
<li><a href="#org7cc0feb">Playing Videos Without JS</a>
<ul>
<li><a href="#orgfe46d0b">Playing Videos</a>
<ul>
<li><a href="#org704cf34">ec-w3m-view-video</a></li>
<li><a href="#org2625945">ec-w3m-video-url?</a></li>
</ul>
</li>
<li><a href="#org881f76f">Redefining Some Functions</a>
<ul>
<li><a href="#orgb71b301">w3m-goto-url-new-session-or-video</a></li>
<li><a href="#orgbacb33c">w3m-view-this-url</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6a9bb47">Search Engine Suggestions</a>
<ul>
<li><a href="#orga868a2b">Variables</a></li>
<li><a href="#org1f04a8d">Functions</a>
<ul>
<li><a href="#orgd888343">ec-ddg-suggest-fetch</a></li>
<li><a href="#org75c12df">ec-ddg-get-suggestions</a></li>
<li><a href="#orgb85cc8c">ec-wikipedia-suggest-fetch</a></li>
<li><a href="#org0144f6a">ec-get-region</a></li>
<li><a href="#org734aba7">ec-ddg-search-interactive-arg</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org970a2d4">Saving Stuff</a>
<ul>
<li><a href="#org0f41e1b">ec-clone-website</a></li>
<li><a href="#org26599f6">ec-download-video</a></li>
</ul>
</li>
<li><a href="#org0adf467">User Interface</a>
<ul>
<li><a href="#org5e54e78">Buffer Names</a></li>
<li><a href="#org470ff93">Hydra Interface</a></li>
<li><a href="#orgbe92e75">Binding Keys</a></li>
<li><a href="#org102275a">Browser Functions</a></li>
<li><a href="#orgec9244b">Ace Link</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-org033b4fa" class="outline-2">
<h2 id="org033b4fa">Introduction</h2>
<div class="outline-text-2" id="text-org033b4fa">
<p>
This is some fo the code I use for search engine stuff in Emacs.
</p>
</div>
</div>

<div id="outline-container-org18eb131" class="outline-2">
<h2 id="org18eb131">Dependencies</h2>
<div class="outline-text-2" id="text-org18eb131">
<table id="org2f5fa9b" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Dependency</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><a href="https://github.com/tkf/emacs-request">request</a></td>
<td class="org-left">A popular library for making requests in Emacs Lisp.</td>
</tr>

<tr>
<td class="org-left"><a href="https://emacs-w3m.github.io/">w3m</a></td>
<td class="org-left">A wrapper around the w3m web browser that exits for Emacs.</td>
</tr>

<tr>
<td class="org-left"><a href="https://github.com/abo-abo/ace-link">ace-link</a></td>
<td class="org-left">A thing that dynamically assigns links key sequences that you can jump to.</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span>ec-load-deps deps<span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org34b4e95" class="outline-2">
<h2 id="org34b4e95">Variables</h2>
<div class="outline-text-2" id="text-org34b4e95">
<p>
Here I set up a bunch of variables that are used in the rest of the package. However, I do not set all my variables here and do make some closer to where they are used. <label class="sidenote-number" for="1"><sup>1</sup></label><input checked="checked" id="1" style="display:none" type="checkbox" /><span class="sidenote"><span class="sidenote-number"> 1</span> I am not sure that this is the best practice, but I am so far from the "best practices" zone with this configuration that I may as well just go with it.</span>
</p>
</div>
<div id="outline-container-orga060223" class="outline-3">
<h3 id="orga060223">Setting Browsers (and stuff)</h3>
<div class="outline-text-3" id="text-orga060223">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defvar</span> <span style="font-style: italic;">ec-graphical-browser</span> <span style="color: #494949;">"firefox"</span>
    <span style="color: #a4a4a4; font-style: italic;">"The browser and options used to browse the web when a non-gui browser will not work."</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defvar</span> <span style="font-style: italic;">ec-search-engine</span> <span style="color: #494949;">"lite.duckduckgo.com/lite/&amp;q="</span>
    <span style="color: #a4a4a4; font-style: italic;">"The search engine string used to search the web."</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defvar</span> <span style="font-style: italic;">ec-video-fstring</span> <span style="color: #494949;">"vlc '%s'  --qt-minimal-view --no-video-title --loop"</span>
  <span style="color: #a4a4a4; font-style: italic;">"The format string used to generate the video playing command."</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defvar</span> <span style="font-style: italic;">ec-graphical-browse-domains</span> '<span style="color: #bbb;">(</span><span style="color: #494949;">"http://127.0.0.1:1337?token="</span>
                                      <span style="color: #494949;">"https://meet.jit.si"</span>
                                      <span style="color: #494949;">"http://localhost:35901/"</span><span style="color: #bbb;">)</span>
  <span style="color: #a4a4a4; font-style: italic;">"Domains that are to be browsed graphically in `</span><span style="color: #E53935; font-style: italic;">w3m-goto-url-new-session-or-video</span><span style="color: #a4a4a4; font-style: italic;">'."</span><span style="color: #494949;">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgb026291" class="outline-3">
<h3 id="orgb026291">The w3m Directory</h3>
<div class="outline-text-3" id="text-orgb026291">
<p>
Like everything else I like to keep the data for w3m in my data directory instead of randomly floating around in the dotfiles, so I change it to the data directory here.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orga003a66">  <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defvar</span> <span style="font-style: italic;">ec-w3m-dir</span> <span style="color: #bbb;">(</span>concat ec-data-dir <span style="color: #494949;">"w3m/"</span><span style="color: #bbb;">)</span>
    <span style="color: #a4a4a4; font-style: italic;">"Directory where all w3m files are located."</span><span style="color: #494949;">)</span>
</pre>
</div>

<p>
Here I set the variables that I have found that need a directory to dump their files in.
</p>
<table id="orgb611d2d" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Variable</th>
<th scope="col" class="org-left">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>w3m-profile-directory</code></td>
<td class="org-left"><code>ec-w3m-dir</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-default-save-directory</code></td>
<td class="org-left"><code>ec-downloads-dir</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-external-view-temp-directory</code></td>
<td class="org-left"><code>ec-w3m-dir</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-bookmark-file</code></td>
<td class="org-left"><code>(concat ec-w3m-dir "bookmarks")</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-cookie-file</code></td>
<td class="org-left">(concat ec-w3m-dir "cookie")</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span>ec-set-variables vars-data-dir<span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgde77ec1" class="outline-3">
<h3 id="orgde77ec1">Further Customizations</h3>
<div class="outline-text-3" id="text-orgde77ec1">
<p>
Now I just add some further quick customizations to make the browser a little nicer to work with and to conform more with my standard interface.
</p>
<table id="org820464e" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Variable</th>
<th scope="col" class="org-left">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>browse-url-browser-function</code></td>
<td class="org-left"><code>#'w3m-goto-url-new-session-or-video</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-default-display-inline-images</code></td>
<td class="org-left"><code>t</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-pop-up-windows</code></td>
<td class="org-left"><code>t</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-search-default-engine</code></td>
<td class="org-left"><code>"duckduckgo"</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-use-tab</code></td>
<td class="org-left"><code>nil</code></td>
</tr>

<tr>
<td class="org-left"><code>w3m-display-mode</code></td>
<td class="org-left"><code>'plain</code></td>
</tr>
</tbody>
</table>


<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span>ec-set-variables vars-further-custom<span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7cc0feb" class="outline-2">
<h2 id="org7cc0feb">Playing Videos Without JS</h2>
<div class="outline-text-2" id="text-org7cc0feb">
<p>
Now I don't really like exiting Emacs, so I have added some features to view videos without javascript.
</p>
</div>
<div id="outline-container-orgfe46d0b" class="outline-3">
<h3 id="orgfe46d0b">Playing Videos</h3>
<div class="outline-text-3" id="text-orgfe46d0b">
</div>
<div id="outline-container-org704cf34" class="outline-4">
<h4 id="org704cf34">ec-w3m-view-video</h4>
<div class="outline-text-4" id="text-org704cf34">
<p>
This function simply calls the view video function on the video.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-w3m-view-video</span> <span style="color: #bbb;">(</span>url <span style="color: #E53935;">&amp;rest</span> _<span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> <span style="color: #494949;">(</span>browse-url-interactive-arg <span style="color: #494949;">"URL: "</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span>start-process-shell-command <span style="color: #494949;">"video"</span>
                               nil
                               <span style="color: #494949;">(</span>format ec-video-fstring url<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2625945" class="outline-4">
<h4 id="org2625945">ec-w3m-video-url?</h4>
<div class="outline-text-4" id="text-org2625945">
<p>
Checks if the video is on a streaming website or if the video content type is something playable with w3m. This way I can directly view videos from download links.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-w3m-video-url?</span> <span style="color: #bbb;">(</span>url<span style="color: #bbb;">)</span>
  <span style="color: #a4a4a4; font-style: italic;">"Determine if a URL is a video, if yes return T, if not return nil."</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">and</span> url <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">or</span> <span style="color: #bbb;">(</span>s-matches? <span style="color: #494949;">"^</span><span style="color: #000; font-weight: bold;">\\</span><span style="color: #000; font-weight: bold;">(</span><span style="color: #494949;">http</span><span style="color: #000; font-weight: bold;">\\</span><span style="color: #000; font-weight: bold;">|</span><span style="color: #494949;">https</span><span style="color: #000; font-weight: bold;">\\</span><span style="color: #000; font-weight: bold;">)</span><span style="color: #494949;">://www.youtube.com/watch\\?v=.*$"</span> url<span style="color: #bbb;">)</span>
               <span style="color: #bbb;">(</span>s-matches? <span style="color: #494949;">"^</span><span style="color: #000; font-weight: bold;">\\</span><span style="color: #000; font-weight: bold;">(</span><span style="color: #494949;">http</span><span style="color: #000; font-weight: bold;">\\</span><span style="color: #000; font-weight: bold;">|</span><span style="color: #494949;">https</span><span style="color: #000; font-weight: bold;">\\</span><span style="color: #000; font-weight: bold;">)</span><span style="color: #494949;">://vimeo.com/[0-9]+$"</span> url<span style="color: #bbb;">)</span>
               <span style="color: #bbb;">(</span>member <span style="color: #494949;">(</span>ec-get-content-type
                        url<span style="color: #494949;">)</span>
                       '<span style="color: #494949;">(</span><span style="color: #494949;">"video/mpg"</span> <span style="color: #494949;">"video/mpeg"</span> <span style="color: #494949;">"video/mp3"</span> <span style="color: #494949;">"video/mp4"</span>
                         <span style="color: #494949;">"video/avi"</span> <span style="color: #494949;">"video/wmv"</span>  <span style="color: #494949;">"video/wav"</span> <span style="color: #494949;">"video/mov"</span>
                         <span style="color: #494949;">"video/flv"</span> <span style="color: #494949;">"video/ogm"</span>  <span style="color: #494949;">"video/ogg"</span> <span style="color: #494949;">"video/mkv"</span>
                         <span style="color: #494949;">"video/webm"</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-org881f76f" class="outline-3">
<h3 id="org881f76f">Redefining Some Functions</h3>
<div class="outline-text-3" id="text-org881f76f">
<p>
Unfortunately, depending on how a video is reached, a different function may be called. I used to just advise the relevant functions, but I have (against the usual recommendations of the Emacs community) come to prefer redefining functions as redefinition ensures that the function at hand works as expected. <label class="sidenote-number" for="2"><sup>2</sup></label><input checked="checked" id="2" style="display:none" type="checkbox" /><span class="sidenote"><span class="sidenote-number"> 2</span> Basically advices are weird and difficult to parse when you get too many of them whereas redefinition is pretty clear and simple.</span>
</p>
</div>

<div id="outline-container-orgb71b301" class="outline-4">
<h4 id="orgb71b301">w3m-goto-url-new-session-or-video</h4>
<div class="outline-text-4" id="text-orgb71b301">
<p>
This opens a buffer in w3m, a graphical web browser, or vlc intelligently. Exciting.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">w3m-goto-url-new-session-or-video</span> <span style="color: #bbb;">(</span>url <span style="color: #E53935;">&amp;rest</span> _<span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">cond</span>  <span style="color: #494949;">(</span><span style="color: #bbb;">(</span>ec-w3m-video-url? url<span style="color: #bbb;">)</span>
          <span style="color: #bbb;">(</span>ec-w3m-view-video url<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
         <span style="color: #494949;">(</span><span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">-&gt;&gt;</span> ec-graphical-browse-domains
            <span style="color: #494949;">(</span>-map <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">lambda</span> <span style="color: #494949;">(</span>domain<span style="color: #494949;">)</span> <span style="color: #494949;">(</span>s-contains? domain url<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
            first<span style="color: #bbb;">)</span>
          <span style="color: #bbb;">(</span>ec-graphical-browse-url url<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
         <span style="color: #494949;">(</span>t <span style="color: #bbb;">(</span>w3m-goto-url-new-session url<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbacb33c" class="outline-4">
<h4 id="orgbacb33c">w3m-view-this-url</h4>
<div class="outline-text-4" id="text-orgbacb33c">
<p>
This just redefines the w3m URL thing entirely, checking if it is a video in the first portion of the cond predicate <code>cond</code> macro.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">w3m-view-this-url</span> <span style="color: #bbb;">(</span><span style="color: #E53935;">&amp;optional</span> arg new-session<span style="color: #bbb;">)</span>
  <span style="color: #a4a4a4; font-style: italic;">"Display the page pointed to by the link under point.</span>
<span style="color: #a4a4a4; font-style: italic;">If ARG is the number 2 or the list of the number 16 (you may produce</span>
<span style="color: #a4a4a4; font-style: italic;">this by typing `</span><span style="color: #E53935; font-style: italic;">C-u</span><span style="color: #a4a4a4; font-style: italic;">' twice) or NEW-SESSION is non-nil and the link is</span>
<span style="color: #a4a4a4; font-style: italic;">an anchor, this function makes a copy of the current buffer in advance.</span>
<span style="color: #a4a4a4; font-style: italic;">Otherwise, if ARG is non-nil, it forces to reload the url at point."</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">if</span> <span style="color: #bbb;">(</span>member current-prefix-arg '<span style="color: #494949;">(</span>2 <span style="color: #bbb;">(</span>16<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
                   <span style="color: #bbb;">(</span>list nil t<span style="color: #bbb;">)</span>
                 <span style="color: #bbb;">(</span>list current-prefix-arg nil<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
  <span style="color: #a4a4a4; font-style: italic;">;; </span><span style="color: #a4a4a4; font-style: italic;">Store the current position in the history structure.</span>
  <span style="color: #bbb;">(</span>w3m-history-store-position<span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">let</span> <span style="color: #494949;">(</span><span style="color: #bbb;">(</span>w3m-prefer-cache
         <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">or</span> w3m-prefer-cache
             <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">and</span> <span style="color: #494949;">(</span>stringp w3m-current-url<span style="color: #494949;">)</span>
                  <span style="color: #494949;">(</span>string-match <span style="color: #494949;">"\\`about://</span><span style="color: #000; font-weight: bold;">\\</span><span style="color: #000; font-weight: bold;">(?:</span><span style="color: #494949;">db-</span><span style="color: #000; font-weight: bold;">\\</span><span style="color: #000; font-weight: bold;">)</span><span style="color: #494949;">?history/"</span>
                                w3m-current-url<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
        act url<span style="color: #494949;">)</span>
    <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">cond</span>
     <span style="color: #bbb;">(</span><span style="color: #494949;">(</span>ec-w3m-video-url? <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">w3m-anchor</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">progn</span> <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">w3m-arrived-intern</span> <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">w3m-anchor</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
             <span style="color: #bbb;">(</span>ec-w3m-view-video <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">w3m-anchor</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
             <span style="color: #bbb;">(</span>w3m-redisplay-this-page<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
     <span style="color: #bbb;">(</span><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">setq</span> act <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">w3m-action</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">let</span> <span style="color: #bbb;">(</span><span style="color: #494949;">(</span>w3m-form-new-session new-session<span style="color: #494949;">)</span>
            <span style="color: #494949;">(</span>w3m-form-download nil<span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
        <span style="color: #bbb;">(</span>ignore w3m-form-new-session w3m-form-download<span style="color: #bbb;">)</span>
        <span style="color: #bbb;">(</span>eval act<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
     <span style="color: #bbb;">(</span><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">setq</span> url <span style="color: #bbb;">(</span>w3m-url-valid <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">w3m-anchor</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">if</span> new-session
          <span style="color: #bbb;">(</span>w3m-goto-url-new-session url arg<span style="color: #bbb;">)</span>
        <span style="color: #bbb;">(</span>w3m-goto-url url arg<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
     <span style="color: #bbb;">(</span><span style="color: #494949;">(</span>w3m-url-valid <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">w3m-image</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">if</span> <span style="color: #bbb;">(</span>display-images-p<span style="color: #bbb;">)</span>
          <span style="color: #bbb;">(</span>w3m-toggle-inline-image<span style="color: #bbb;">)</span>
        <span style="color: #bbb;">(</span>w3m-view-image<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
     <span style="color: #bbb;">(</span><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">setq</span> url <span style="color: #bbb;">(</span>w3m-active-region-or-url-at-point 'never<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">unless</span> <span style="color: #bbb;">(</span>eq 'quit <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">setq</span> url <span style="color: #bbb;">(</span>w3m-input-url nil url 'quit nil
                                                 'feeling-searchy 'no-initial<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
        <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">if</span> new-session
            <span style="color: #494949;">(</span>w3m-goto-url-new-session url arg<span style="color: #494949;">)</span>
          <span style="color: #494949;">(</span>w3m-goto-url url arg<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
     <span style="color: #bbb;">(</span>t <span style="color: #494949;">(</span>w3m-message <span style="color: #494949;">"No URL at point"</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org6a9bb47" class="outline-2">
<h2 id="org6a9bb47">Search Engine Suggestions</h2>
<div class="outline-text-2" id="text-org6a9bb47">
<p>
To add search engine suggestions
</p>
</div>
<div id="outline-container-orga868a2b" class="outline-3">
<h3 id="orga868a2b">Variables</h3>
<div class="outline-text-3" id="text-orga868a2b">
<p>
Here I set a list of variables for the search engine suggestions that.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defvar</span> <span style="font-style: italic;">*search-history*</span> '<span style="color: #bbb;">(</span><span style="color: #494949;">"emacs"</span> <span style="color: #494949;">"clojure"</span> <span style="color: #494949;">"julia"</span> <span style="color: #494949;">"logistics"</span><span style="color: #bbb;">)</span>
  <span style="color: #a4a4a4; font-style: italic;">"The search history for the current session."</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defvar</span> <span style="font-style: italic;">*ddg-suggestions*</span> nil
  <span style="color: #a4a4a4; font-style: italic;">"The suggestions sent by DDG."</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defvar</span> <span style="font-style: italic;">*ddg-search-string*</span> nil
  <span style="color: #a4a4a4; font-style: italic;">"The string to be searched by DDG."</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f04a8d" class="outline-3">
<h3 id="org1f04a8d">Functions</h3>
<div class="outline-text-3" id="text-org1f04a8d">
</div>
<div id="outline-container-orgd888343" class="outline-4">
<h4 id="orgd888343">ec-ddg-suggest-fetch</h4>
<div class="outline-text-4" id="text-orgd888343">
<p>
This asynchronously fetches suggestions from the <a href="https://duckduckgo.com">duckduckgo</a> API, using a variable to pass the suggestions to the display function.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-duckduckgo-suggest-fetch</span> <span style="color: #bbb;">(</span>input<span style="color: #bbb;">)</span>
    <span style="color: #bbb;">(</span>request <span style="color: #494949;">"https://api.duckduckgo.com/ac/"</span>
      <span style="color: #E53935;">:type</span> <span style="color: #494949;">"POST"</span>
      <span style="color: #E53935;">:params</span> `<span style="color: #494949;">(</span><span style="color: #bbb;">(</span><span style="color: #494949;">"q"</span> . ,input<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      <span style="color: #E53935;">:parser</span> 'json-read
      <span style="color: #E53935;">:success</span> <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">cl-function</span>
                <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">lambda</span> <span style="color: #494949;">(</span><span style="color: #E53935;">&amp;key</span> data <span style="color: #E53935;">&amp;allow-other-keys</span><span style="color: #494949;">)</span>
                  <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">setq</span> *ddg-suggestions*
                        <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">-&gt;&gt;</span> data
                             <span style="color: #494949;">(</span>-map <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">lambda</span> <span style="color: #494949;">(</span>val<span style="color: #494949;">)</span>
                                     <span style="color: #494949;">(</span>cdar val<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>

</pre>
</div>
</div>
</div>


<div id="outline-container-org75c12df" class="outline-4">
<h4 id="org75c12df">ec-ddg-get-suggestions</h4>
<div class="outline-text-4" id="text-org75c12df">
<p>
Here we define a pretty simple function to get the list of suggestions for the search engine and merge them with the search history. It also starts a new request for suggestions.<label class="sidenote-number" for="3"><sup>3</sup></label><input checked="checked" id="3" style="display:none" type="checkbox" /><span class="sidenote"><span class="sidenote-number"> 3</span> Unfortunately this doesn't actually work fully</span>
</p>


<p>
I also use the rx-macro to dynamically filter out suggestions that don't contain any of the words currently in the input.
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-ddg-get-suggestions</span> <span style="color: #bbb;">(</span>input<span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">when</span> <span style="color: #494949;">(</span>not <span style="color: #bbb;">(</span>s-equals? input *ddg-search-string*<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
    <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">setq</span> *ddg-search-string* input<span style="color: #494949;">)</span>
    <span style="color: #494949;">(</span>ec-duckduckgo-suggest-fetch input<span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">-&gt;&gt;</span> *search-history*
    <span style="color: #494949;">(</span>-filter <span style="color: #bbb;">(</span>-partial 's-matches? <span style="color: #494949;">(</span>rx-to-string `<span style="color: #bbb;">(</span>seq ,@<span style="color: #494949;">(</span>s-split-words input<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
    <span style="color: #494949;">(</span>-union *ddg-suggestions*<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb85cc8c" class="outline-4">
<h4 id="orgb85cc8c">ec-wikipedia-suggest-fetch</h4>
<div class="outline-text-4" id="text-orgb85cc8c">
<p>
I also like to browse wikipedia. <label class="sidenote-number" for="4"><sup>4</sup></label><input checked="checked" id="4" style="display:none" type="checkbox" /><span class="sidenote"><span class="sidenote-number"> 4</span> Unfortunately this function doesn't work yet, but soonâ„¢, it will.</span>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-wikipedia-suggest-fetch</span> <span style="color: #bbb;">(</span>input<span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">let</span> <span style="color: #494949;">(</span><span style="color: #bbb;">(</span>input <span style="color: #494949;">"emacs"</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
    <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">-&gt;&gt;</span> <span style="color: #bbb;">(</span>request <span style="color: #494949;">"https://en.wikipedia.org/w/api.php"</span>
           <span style="color: #E53935;">:type</span> <span style="color: #494949;">"GET"</span>
           <span style="color: #E53935;">:params</span> `<span style="color: #494949;">(</span><span style="color: #bbb;">(</span><span style="color: #494949;">"action"</span> . <span style="color: #494949;">"opensearch"</span><span style="color: #bbb;">)</span>
                     <span style="color: #bbb;">(</span><span style="color: #494949;">"format"</span> . <span style="color: #494949;">"json"</span><span style="color: #bbb;">)</span>
                     <span style="color: #bbb;">(</span><span style="color: #494949;">"search"</span> . <span style="color: #494949;">"emacs"</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
           <span style="color: #E53935;">:parser</span> 'json-read
           <span style="color: #E53935;">:sync</span> t<span style="color: #bbb;">)</span>
      request-response-data<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0144f6a" class="outline-4">
<h4 id="org0144f6a">ec-get-region</h4>
<div class="outline-text-4" id="text-org0144f6a">
<p>
This is a simple function to grab a region if it is highlighted, else return nil. IDK if it is defined in emacs elsewhere or not, but I decided to add it anyways because it might not be. <label class="sidenote-number" for="5"><sup>5</sup></label><input checked="checked" id="5" style="display:none" type="checkbox" /><span class="sidenote"><span class="sidenote-number"> 5</span> Yes, I know that is a terrible idea.</span>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-get-region</span> <span style="color: #bbb;">()</span>
    <span style="color: #a4a4a4; font-style: italic;">"Get the text  or return a empty string if it is not present."</span>
    <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">if</span> <span style="color: #494949;">(</span>use-region-p<span style="color: #494949;">)</span>
        <span style="color: #494949;">(</span>buffer-substring-no-properties <span style="color: #bbb;">(</span>region-beginning<span style="color: #bbb;">)</span> <span style="color: #bbb;">(</span>region-end<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      <span style="color: #494949;">""</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org734aba7" class="outline-4">
<h4 id="org734aba7">ec-ddg-search-interactive-arg</h4>
<div class="outline-text-4" id="text-org734aba7">
<p>
This searches using my suggestions. I use it mostly to build more complex functions for searching the web.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-ddg-search-interactive-arg</span> <span style="color: #bbb;">(</span>prompt<span style="color: #bbb;">)</span>
    <span style="color: #a4a4a4; font-style: italic;">"Search `</span><span style="color: #E53935; font-style: italic;">w3m-search-default-engine</span><span style="color: #a4a4a4; font-style: italic;">' with ddg completion candidates."</span>
    <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">let</span> <span style="color: #494949;">(</span><span style="color: #bbb;">(</span>ec-ddg-search <span style="color: #494949;">(</span>ivy-read  prompt
                                     #'ec-ddg-get-suggestions
                                     <span style="color: #E53935;">:initial-input</span> <span style="color: #bbb;">(</span>ec-get-region<span style="color: #bbb;">)</span>
                                     <span style="color: #E53935;">:dynamic-collection</span> t<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">setq</span> *search-history* <span style="color: #bbb;">(</span>cons ec-ddg-search *search-history*<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
      `<span style="color: #494949;">(</span>,ec-ddg-search<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>



<div id="outline-container-org970a2d4" class="outline-2">
<h2 id="org970a2d4">Saving Stuff</h2>
<div class="outline-text-2" id="text-org970a2d4">
<p>
I also like to occasionally save documentation, so I have written some functions to make that easier.
</p>
</div>
<div id="outline-container-org0f41e1b" class="outline-3">
<h3 id="org0f41e1b">ec-clone-website</h3>
<div class="outline-text-3" id="text-org0f41e1b">
<p>
This just clones a website fully and places it in a directory with the name of the website.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-clone-website</span> <span style="color: #bbb;">(</span>url dirname<span style="color: #bbb;">)</span>
  <span style="color: #a4a4a4; font-style: italic;">"Clone a wesbiste to directory."</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> `<span style="color: #494949;">(</span>,<span style="color: #bbb;">(</span>read-string <span style="color: #494949;">"URL: "</span><span style="color: #bbb;">)</span>
                 ,<span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">-&gt;</span> <span style="color: #494949;">(</span>read-string <span style="color: #494949;">"Directory name: "</span><span style="color: #494949;">)</span>
                    <span style="color: #494949;">(</span>s-trim<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span>exec-shell-command <span style="color: #494949;">(</span>format <span style="color: #494949;">"httrack \"%s\" -O ~/Websites/%s"</span> url dirname<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org26599f6" class="outline-3">
<h3 id="org26599f6">ec-download-video</h3>
<div class="outline-text-3" id="text-org26599f6">
<p>
Sometimes while watching videos from C3 I like to download them, so this is a small, easy function that allows me to do just that.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-download-video</span> <span style="color: #bbb;">(</span>url <span style="color: #E53935;">&amp;rest</span> _<span style="color: #bbb;">)</span>
    <span style="color: #a4a4a4; font-style: italic;">"Download a youtube video."</span>
    <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> <span style="color: #494949;">(</span>browse-url-interactive-arg <span style="color: #494949;">"URL: "</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
    <span style="color: #bbb;">(</span>exec-shell-command <span style="color: #494949;">(</span>concat <span style="color: #494949;">"youtube-dl -f bestaudio --extract-audio --audio-format mp3 --audio-quality 0 '"</span>
                                url
                                <span style="color: #494949;">"'"</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org0adf467" class="outline-2">
<h2 id="org0adf467">User Interface</h2>
<div class="outline-text-2" id="text-org0adf467">
<p>
This is the porcelain of the system. Eventually I think I will separate this into multiple different porcelains (which won't be unit-tested) and libraries (which will).
</p>
</div>

<div id="outline-container-org5e54e78" class="outline-3">
<h3 id="org5e54e78">Buffer Names</h3>
<div class="outline-text-3" id="text-org5e54e78">
<p>
Here we add a function to rename the buffers to the current title to make them both more manageable and searchable than they were otherwise. <label class="sidenote-number" for="6"><sup>6</sup></label><input checked="checked" id="6" style="display:none" type="checkbox" /><span class="sidenote"><span class="sidenote-number"> 6</span> One of my pet-peeves was that w3m didn't really have good names for buffers, instead giving them the usual numeric names which sucked.</span>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-w3m-rename-buffer-name</span> <span style="color: #bbb;">()</span>
  <span style="color: #a4a4a4; font-style: italic;">"Rename the current buffer to whatever the current title is."</span>
  <span style="color: #bbb;">(</span>rename-buffer <span style="color: #494949;">(</span>format <span style="color: #494949;">"*world wide web: %s*"</span> w3m-current-title<span style="color: #494949;">)</span> t<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span>add-hook 'w3m-fontify-before-hook #'ec-w3m-rename-buffer-name<span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org470ff93" class="outline-3">
<h3 id="org470ff93">Hydra Interface</h3>
<div class="outline-text-3" id="text-org470ff93">
<p>
We also throw in a hydra interface to make all of this much easier to work with.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">ec-defhydra</span> hydra-web <span style="color: #ffffff; background-color: #0000ff;">blue</span>
  <span style="color: #bbb;">(</span>'material <span style="color: #494949;">"search"</span> <span style="color: #494949;">"Search the World Wide Web"</span><span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #494949;">"Search"</span>
   <span style="color: #494949;">(</span><span style="color: #bbb;">(</span><span style="color: #494949;">"s"</span> ec-search-interactively-new-session<span style="color: #494949;">"search the web"</span><span style="color: #bbb;">)</span>
    <span style="color: #bbb;">(</span><span style="color: #494949;">"u"</span> w3m-goto-url-new-session  <span style="color: #494949;">"view URL"</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
   <span style="color: #494949;">"Graphical Search"</span>
   <span style="color: #494949;">(</span><span style="color: #bbb;">(</span><span style="color: #494949;">"C-u"</span> ec-graphical-browse-url <span style="color: #494949;">"view URL using graphical browser"</span><span style="color: #bbb;">)</span>
    <span style="color: #bbb;">(</span><span style="color: #494949;">"C-s"</span> ec-graphical-search <span style="color: #494949;">"search using graphical browser"</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
   <span style="color: #494949;">"Site"</span>
   <span style="color: #494949;">(</span><span style="color: #bbb;">(</span><span style="color: #494949;">"D"</span> <span style="color: #494949;">(</span>ec-graphical-browse-url <span style="color: #494949;">"https://discord.com/app"</span><span style="color: #494949;">)</span> <span style="color: #494949;">"discord.com/app"</span><span style="color: #bbb;">)</span>
    <span style="color: #bbb;">(</span><span style="color: #494949;">"t"</span> <span style="color: #494949;">(</span>ec-graphical-browse-url <span style="color: #494949;">"https://twitter.com"</span><span style="color: #494949;">)</span> <span style="color: #494949;">"twitter.com"</span><span style="color: #bbb;">)</span>
    <span style="color: #bbb;">(</span><span style="color: #494949;">"y"</span> ec-search-yt-interactively <span style="color: #494949;">"youtube.com"</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">bind-key</span> <span style="color: #bbb;">(</span>kbd <span style="color: #494949;">"C-c w"</span><span style="color: #bbb;">)</span> #'hydra-web/body<span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgbe92e75" class="outline-3">
<h3 id="orgbe92e75">Binding Keys</h3>
<div class="outline-text-3" id="text-orgbe92e75">
<p>
To regularize the user interface we bind a bunch of keys that are, for some ineffable reason, not bound in a standard way. To rebind the keys in the mode I use the table and function call below.
</p>

<table id="org291af0e" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Chord</th>
<th scope="col" class="org-left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">s</td>
<td class="org-left">ec-search-interactively</td>
</tr>

<tr>
<td class="org-left">S</td>
<td class="org-left">ec-search-interactively-new-session</td>
</tr>

<tr>
<td class="org-left">q</td>
<td class="org-left">quit-window</td>
</tr>

<tr>
<td class="org-left">f</td>
<td class="org-left">w3m-view-next-page</td>
</tr>

<tr>
<td class="org-left">b</td>
<td class="org-left">w3m-view-previous-page</td>
</tr>

<tr>
<td class="org-left">n</td>
<td class="org-left">w3m-next-anchor</td>
</tr>

<tr>
<td class="org-left">p</td>
<td class="org-left">w3m-previous-anchor</td>
</tr>

<tr>
<td class="org-left">M-s</td>
<td class="org-left">w3m-select-buffer</td>
</tr>

<tr>
<td class="org-left">&lt;right&gt;</td>
<td class="org-left">forward-char</td>
</tr>

<tr>
<td class="org-left">&lt;left&gt;</td>
<td class="org-left">backward-char</td>
</tr>

<tr>
<td class="org-left">&lt;up&gt;</td>
<td class="org-left">previous-line</td>
</tr>

<tr>
<td class="org-left">&lt;down&gt;</td>
<td class="org-left">next-line</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">w3m-history</td>
</tr>

<tr>
<td class="org-left">C-c C-d</td>
<td class="org-left">lexic-search-word-at-point</td>
</tr>

<tr>
<td class="org-left">g</td>
<td class="org-left">w3m-redisplay-this-page</td>
</tr>

<tr>
<td class="org-left">G</td>
<td class="org-left">w3m-reload-this-page</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">w3m-goto-url</td>
</tr>

<tr>
<td class="org-left">U</td>
<td class="org-left">w3m-goto-url-new-session</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span>ec-bind-keys w3m-bound-keys 'w3m-mode-map<span style="color: #494949;">)</span>
</pre>
</div>

<p>
I also add my system for creating epubs from websites automatically so I can write notes on the websites in org-mode.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">use-package</span> <span style="color: #E53935;">w3m</span> <span style="color: #E53935;">:config</span> <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">bind-key</span> <span style="color: #494949;">(</span>kbd <span style="color: #494949;">"w"</span><span style="color: #494949;">)</span>
           <span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">def-web-note-writer</span> w3m-mode w3m-current-url w3m-current-title<span style="color: #494949;">)</span>
           'w3m-mode-map<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org102275a" class="outline-3">
<h3 id="org102275a">Browser Functions</h3>
<div class="outline-text-3" id="text-org102275a">
<p>
To make all of it work I also have to define a series of browser functions that will be called in the hydra.
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-graphical-browse-url</span> <span style="color: #bbb;">(</span>url <span style="color: #E53935;">&amp;rest</span> _<span style="color: #bbb;">)</span>
  <span style="color: #a4a4a4; font-style: italic;">"Browse a URL using the graphical browser."</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> <span style="color: #494949;">(</span>browse-url-interactive-arg <span style="color: #bbb;">(</span>format <span style="color: #494949;">"Open URL in %s: "</span> ec-graphical-browser<span style="color: #bbb;">)</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>  <span style="color: #bbb;">(</span>start-process-shell-command <span style="color: #494949;">"ec-graphical-browser"</span>
                               nil
                               <span style="color: #494949;">(</span>format <span style="color: #494949;">"%s '%s'"</span> ec-graphical-browser url<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-graphical-search</span> <span style="color: #bbb;">(</span>search-terms<span style="color: #bbb;">)</span>
  <span style="color: #a4a4a4; font-style: italic;">"Open the graphical browser in a buffer for browsing various websites."</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> <span style="color: #494949;">(</span>ec-ddg-search-interactive-arg <span style="color: #494949;">"Search in graphical browser. DuckDuckGo Search: "</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span>exec-shell-command ec-graphical-browser <span style="color: #494949;">"\"https://"</span> ec-search-engine search-terms <span style="color: #494949;">"\""</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-search-interactively-new-session</span> <span style="color: #bbb;">(</span>search-terms<span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> <span style="color: #494949;">(</span>ec-ddg-search-interactive-arg <span style="color: #494949;">"Search in new buffer. DuckDuckGo Search: "</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span>w3m-search-new-session w3m-search-default-engine search-terms<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-search-interactively</span> <span style="color: #bbb;">(</span>search-terms<span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> <span style="color: #494949;">(</span>ec-ddg-search-interactive-arg <span style="color: #494949;">"Search in current buffer. DuckDuckGo Search: "</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span>w3m-search w3m-search-default-engine search-terms<span style="color: #bbb;">)</span><span style="color: #494949;">)</span>

<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">defun</span> <span style="font-weight: bold; font-style: italic;">ec-search-yt-interactively</span> <span style="color: #bbb;">(</span>search-terms<span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span><span style="color: #E53935; font-style: italic;">interactive</span> <span style="color: #494949;">(</span>ec-ddg-search-interactive-arg <span style="color: #494949;">"Search in current buffer. Youtube Search: "</span><span style="color: #494949;">)</span><span style="color: #bbb;">)</span>
  <span style="color: #bbb;">(</span>w3m-search-new-session w3m-search-default-engine <span style="color: #494949;">(</span>format <span style="color: #494949;">"site:youtube.com %s"</span> search-terms<span style="color: #494949;">)</span><span style="color: #bbb;">)</span><span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgec9244b" class="outline-3">
<h3 id="orgec9244b">Ace Link</h3>
<div class="outline-text-3" id="text-orgec9244b">
<p>
Now I just add <a href="https://github.com/abo-abo/ace-link">ace-link</a> to make traversing documents much nicer. 
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #494949;">(</span>ace-link-setup-default<span style="color: #494949;">)</span>
<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">bind-key</span> <span style="color: #bbb;">(</span>kbd <span style="color: #494949;">"C-o"</span><span style="color: #bbb;">)</span> #'ace-link<span style="color: #494949;">)</span>
<span style="color: #494949;">(</span><span style="color: #E53935; font-style: italic;">bind-key</span> <span style="color: #bbb;">(</span>kbd <span style="color: #494949;">"o"</span><span style="color: #bbb;">)</span> #'ace-link 'w3m-mode-map<span style="color: #494949;">)</span>
</pre>
</div>
</div>
</div>
</div>
<!-- Footnotes --><!-- 
<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">I am not sure that this is the best practice, but I am so far from the "best practices" zone with this configuration that I may as well just go with it.</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">Basically advices are weird and difficult to parse when you get too many of them whereas redefinition is pretty clear and simple.</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3" role="doc-backlink">3</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">Unfortunately this doesn't actually work fully</p></div></div>

<div class="footdef"><sup><a id="fn.4" class="footnum" href="#fnr.4" role="doc-backlink">4</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">Unfortunately this function doesn't work yet, but soonâ„¢, it will.</p></div></div>

<div class="footdef"><sup><a id="fn.5" class="footnum" href="#fnr.5" role="doc-backlink">5</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">Yes, I know that is a terrible idea.</p></div></div>

<div class="footdef"><sup><a id="fn.6" class="footnum" href="#fnr.6" role="doc-backlink">6</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">One of my pet-peeves was that w3m didn't really have good names for buffers, instead giving them the usual numeric names which sucked.</p></div></div>

 --></div>
<div id="postamble" class="status">
<p class="date">Last Modified: 2021-W50-6 00:53</p><p class="creator">Generated Using: <a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.2 (<a href="https://orgmode.org">Org</a> mode 9.4.6)</p><p class="license">Except where otherwise noted content on <a href="https://cons.dev">cons.dev</a> is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="license">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
</div>
</body>
</html>
